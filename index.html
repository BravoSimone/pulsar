<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Pulsar by nebulab</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Pulsar</h1>
        <p>Manage your Capistrano deployments with ease</p>
        <p class="view"><a href="https://github.com/nebulab/pulsar">View the Project on GitHub <small>nebulab/pulsar</small></a></p>
        <ul>
          <li><a href="https://github.com/nebulab/pulsar/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/nebulab/pulsar/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/nebulab/pulsar">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><a href="http://badge.fury.io/rb/pulsar"><img src="https://badge.fury.io/rb/pulsar.png" alt="Gem Version"></a> <a href="http://travis-ci.org/nebulab/pulsar"><img src="https://secure.travis-ci.org/nebulab/pulsar.png?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/r/nebulab/pulsar"><img src="https://coveralls.io/repos/nebulab/pulsar/badge.png?branch=master" alt="Coverage Status"></a> <a href="https://codeclimate.com/github/nebulab/pulsar"><img src="https://codeclimate.com/github/nebulab/pulsar.png" alt="Code Climate"></a></p>

<p>The easy <a href="https://rubygems.org/gems/capistrano">Capistrano</a> deploy and configuration manager.</p>

<p>Pulsar allows you to run capistrano tasks via a separate repository where all your deploy configurations are stored.
Once you have your own repository, you can gradully add configurations and recipes so that you never have to duplicate code again.</p>

<p>The way Pulsar works means that you can deploy without actually having the application on your local machine (and neither
have all your application dependencies installed). This lets you integrate Pulsar with nearly any deploy strategy you can think of.</p>

<p>Some of the benefits of using Pulsar:</p>

<ul>
<li>No capistrano configurations in the application code</li>
<li>No need to have the application locally to deploy</li>
<li>Multistage support by default</li>
<li>Every recipe can be shared between all applications</li>
<li>Can easily be integrated with other tools</li>
<li>Write the least possible code to deploy</li>
</ul><h2>Installation</h2>

<p>The most useful way of installing Pulsar is as a system gem:</p>

<div class="highlight"><pre><span class="nv">$ </span>gem install pulsar
</pre></div>

<p>This will install two commands: <code>pulsar</code> and <code>pulsar-utils</code>. The first command is required to run capistrano,
the other is for everything else.</p>

<hr><p>You'll need to create your own configuration repo:</p>

<div class="highlight"><pre><span class="nv">$ </span>pulsar-utils init ~/Desktop/pulsar-conf
</pre></div>

<p>This will create a basic start point for building your configuration repository. As soon as you're done configuring
you should consider storing this folder as an actual git repository.</p>

<p>Here it is possible to see how this configuration repository will look like: <a href="http://github.com/nebulab/pulsar-conf-demo">Pulsar Conf Demo</a> </p>

<p><strong>NOTE</strong>: Pulsar only supports git and *nix systems.</p>

<h2>Configuration</h2>

<p>This is an example repository configuration layout:</p>

<div class="highlight"><pre>pulsar-conf/
  |── Gemfile
  ├── Gemfile.lock
  ├── apps
  │   ├── base.rb
  │   └── my_application
  │       ├── defaults.rb
  │       ├── production.rb
  │       ├── recipes
  │       │   └── custom_recipe.rb
  │       └── staging.rb
  └── recipes
      ├── generic
      │   ├── cleanup.rb
      │   ├── maintenance_mode.rb
      │   ├── notify.rb
      │   └── rake.rb
      ├── rails
      │   ├── passenger.rb
      │   ├── repair_permissions.rb
      │   ├── symlink_configs.rb
      │   ├── unicorn.rb
      │   └── whenever.rb
      └── spree_1
          └── symlink_assets.rb
</pre></div>

<p>Pulsar uses these files to build capistrano configurations on the fly, depending on how you invoke the <code>pulsar</code> command.
Since Pulsar it's basically a capistrano wrapper, the content of these files is plain old capistrano syntax.</p>

<h3>
<em>apps</em> directory</h3>

<p>This directory contains your application configurations. You'll have one directory per application.</p>

<ul>
<li>
<code>base.rb</code> has configurations that are shared by all applications</li>
<li>
<code>my_application/defaults.rb</code> includes configuration shared by every stage of the application</li>
<li>
<code>my_application/staging.rb</code> and <code>my_application/production.rb</code> files include stage configurations</li>
<li>
<code>my_application/recipes/</code> are recipes that are always included for that application (no need to use <code>load_recipes</code>)</li>
</ul><h3>
<em>recipes</em> directory</h3>

<p>This directory contains your recipes. You can create any number of directories to organize your recipes.
To load a recipe from your configurations you can use the <code>load_recipes</code> helper:</p>

<div class="highlight"><pre><span class="c1">#</span>
<span class="c1"># Somewhere inside apps/</span>
<span class="c1">#</span>
<span class="n">load_recipes</span> <span class="k">do</span>
  <span class="n">rails</span> <span class="ss">:repair_permissions</span><span class="p">,</span> <span class="ss">:unicorn</span>
  <span class="n">generic</span> <span class="ss">:cleanup</span><span class="p">,</span> <span class="ss">:rake</span>
<span class="k">end</span>
</pre></div>

<p>This will use capistrano's <code>load</code> method to include recipes from <code>rails/</code> and <code>generic/</code>.</p>

<hr><p>Another way to include your recipes is by using the <code>Gemfile</code>. Many gems already include custom recipes for capistrano so
you just need to require those. An example with <a href="https://github.com/javan/whenever">Whenever</a>:</p>

<div class="highlight"><pre><span class="c1">#</span>
<span class="c1"># Inside Gemfile</span>
<span class="c1">#</span>
<span class="n">gem</span> <span class="s1">'whenever'</span>

<span class="c1">#</span>
<span class="c1"># Inside recipes/rails/whenever.rb</span>
<span class="c1">#</span>
<span class="nb">require</span> <span class="s1">'whenever/capistrano'</span>

<span class="n">set</span> <span class="ss">:whenever_command</span><span class="p">,</span> <span class="s2">"bundle exec whenever"</span>

<span class="c1">#</span>
<span class="c1"># Somewhere inside apps/</span>
<span class="c1">#</span>
<span class="n">load_recipes</span> <span class="k">do</span>
  <span class="n">rails</span> <span class="ss">:whenever</span>
<span class="k">end</span>
</pre></div>

<hr><p>You can specify some recipes to be loaded only when you run Pulsar from inside a Rack application directory.
This is useful with recipes that require something inside that directory (like retrieving the database/assets
from a staging environment). </p>

<p>You can do that like this:</p>

<div class="highlight"><pre><span class="c1">#</span>
<span class="c1"># Somewhere inside apps/</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="c1"># These recipes will be available only if you're running </span>
<span class="c1"># Pulsar inside a Rack application (like Rails) directory</span>
<span class="c1">#</span>
<span class="n">load_recipes</span><span class="p">(</span><span class="n">app_only</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">rails</span> <span class="ss">:assets_pull</span><span class="p">,</span> <span class="ss">:database_pull</span>
<span class="k">end</span>
</pre></div>

<h3>Loading the repository</h3>

<p>Once the repository is ready, you'll need to tell Pulsar where it is. The repository location can be specified either
as a full git path or a github repository path (<code>gh-user/pulsar-conf</code>).</p>

<p>Since Pulsar requires the repository for everything, there are multiple ways to store this information so that 
you don't have to type it everytime.</p>

<p>You have three possibilities:</p>

<ul>
<li>
<code>-c</code> command line option</li>
<li>
<code>PULSAR_CONF_REPO</code> environment variable</li>
<li>
<code>~/.pulsar</code> configuration file</li>
</ul><p>The fastest way is probably the <code>.pulsar</code> hidden file inside your home directory:</p>

<div class="highlight"><pre><span class="c">#</span>
<span class="c"># Inside ~/.pulsar</span>
<span class="c">#</span>
<span class="nv">PULSAR_CONF_REPO</span><span class="o">=</span><span class="s2">"gh-user/pulsar-conf"</span> 

<span class="c">#</span>
<span class="c"># Also supported</span>
<span class="c">#</span>
<span class="c"># PULSAR_CONF_REPO="git://github.com/gh-user/pulsar-conf.git"</span>
</pre></div>

<p>Pulsar will read this file and set the environment variables properly.</p>

<hr><p>If you don't want to add another file to your home directory you can export the variables yourself:</p>

<div class="highlight"><pre><span class="c">#</span>
<span class="c"># Inside ~/.bash_profile or ~/.zshrc</span>
<span class="c">#</span>
<span class="nb">export </span><span class="nv">PULSAR_CONF_REPO</span><span class="o">=</span><span class="s2">"gh-user/pulsar-conf"</span> 
</pre></div>

<h2>Usage</h2>

<p>After the repository is ready, running Pulsar is straightforward. To deploy <code>my_application</code> to <code>production</code>:</p>

<div class="highlight"><pre><span class="nv">$ </span>pulsar my_application production
</pre></div>

<p>As a rule of thumb, anything that's added at the end of the command is passed to capistrano. Some examples:</p>

<div class="highlight"><pre><span class="nv">$ </span>pulsar my_application production --tasks

<span class="nv">$ </span>pulsar my_application staging deploy:migrations

<span class="nv">$ </span>pulsar my_application staging shell

<span class="c">#</span>
<span class="c"># Deploy multiple apps by using commas </span>
<span class="c">#</span>
<span class="nv">$ </span>pulsar my_app1,my_app2,my_app3 production
</pre></div>

<h3>Running inside a Rack application (e.g. Ruby on Rails application)</h3>

<p>In case you frequently work from a Rack application and would like a workflow similar to that of capistrano, Pulsar
supports running from inside a Rack application directory. If you use this a lot, you should consider installing
Pulsar via the application <code>Gemfile</code>.</p>

<p>When deploying from inside a Rack application you can omit the application name:</p>

<div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd</span> /path/to/my_application

<span class="nv">$ </span>pulsar production

<span class="nv">$ </span>pulsar staging deploy:migrations
</pre></div>

<hr><p>If you need a particular configuration for an application you can store a <code>.pulsar</code> file inside the application
directory:</p>

<div class="highlight"><pre><span class="c">#</span>
<span class="c"># Inside /path/to/my_application/.pulsar</span>
<span class="c">#</span>
<span class="nv">PULSAR_CONF_REPO</span><span class="o">=</span><span class="s2">"gh-user/pulsar-conf"</span>

<span class="c">#</span>
<span class="c"># If the application directory name is different than what</span>
<span class="c"># you configured inside the Pulsar configuration repository</span>
<span class="c">#</span>
<span class="c"># PULSAR_APP_NAME="my-application"</span>
</pre></div>

<h2>Integrations</h2>

<p>Pulsar is easy to integrate, you just need access to the configurations repository and the ability to
run a command.</p>

<h3>Hubot</h3>

<p><a href="https://gist.github.com/mtylty/5324075">https://gist.github.com/mtylty/5324075</a></p>

<h2>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes with tests (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/nebulab">nebulab</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-25604808-7");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>